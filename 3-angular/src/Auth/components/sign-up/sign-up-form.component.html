<section fxLayoutAlign="center center">
  <img class="sign-up-image" src="assets/art/secure_login.png" alt="" />
</section>

<h1>Register</h1>

<form [formGroup]="signUpUserDataForm">
  <!-- EMAIL -->
  <mat-form-field appearance="outline">
    <mat-error *ngIf="signUpUserDataForm.get('email')?.hasError('required')"
      >Email is required</mat-error
    >
    <mat-error *ngIf="signUpUserDataForm.get('email')?.hasError('email')">
      Input real email address
    </mat-error>
    <mat-label>Email</mat-label>
    <input
      matInput
      type="email"
      autocomplete="email"
      required
      maxlength="40"
      formControlName="email"
    />
    <mat-icon matPrefix>mail</mat-icon>
    <mat-hint>E.g. funny.guy@gmail.com (You will login with email)</mat-hint>
  </mat-form-field>

  <!-- NICKNAME -->
  <mat-form-field appearance="outline">
    <mat-error *ngIf="signUpUserDataForm.get('nickname')?.hasError('required')"
      >Nickname is required</mat-error
    >
    <mat-error *ngIf="signUpUserDataForm.get('nickname')?.hasError('pattern')">
      Only letters and numbers are allowed
    </mat-error>
    <mat-label>Nickname</mat-label>
    <input
      matInput
      type="text"
      required
      maxlength="30"
      formControlName="nickname"
    />
    <mat-icon matPrefix>account_circle</mat-icon>
    <mat-hint>E.g. FunnyGuy123</mat-hint>
  </mat-form-field>
</form>

<form [formGroup]="passwordsForm">
  <!-- PASSWORD -->
  <mat-form-field
    appearance="outline"
    hintLabel="Should be at least 8 characters long."
  >
    <mat-error *ngIf="passwordsForm.get('password')?.hasError('minlength')"
      >Password required length 8</mat-error
    >
    <mat-error *ngIf="passwordsForm.get('password')?.hasError('required')"
      >Password is required</mat-error
    >
    <mat-error *ngIf="passwordsForm.get('password')?.hasError('pattern')">
      White space is not allowed in the start or the end
    </mat-error>
    <mat-label>Password</mat-label>
    <input
      matInput
      [type]="showPassword ? 'text' : 'password'"
      required
      minlength="8"
      maxlength="40"
      formControlName="password"
    />
    <mat-icon matPrefix>lock</mat-icon>
    <mat-icon
      matSuffix
      (click)="showPassword = !showPassword"
      class="toggleShowPasswordButton"
      >{{ showPassword ? "visibility" : "visibility_off" }}</mat-icon
    >
    <mat-hint align="end">
      {{ passwordsForm.get("password")?.value?.length }} / 8</mat-hint
    >
  </mat-form-field>

  <!-- CONFIRM PASSWORD -->
  <mat-form-field appearance="outline">
    <mat-error
      *ngIf="
        passwordsForm.get('passwordConfirm')?.dirty
      "
    >
      Passwords need to be same
    </mat-error>
    <mat-label>Confirm password</mat-label>
    <input
      matInput
      maxlength="40"
      [errorStateMatcher]="matcher"
      [type]="showPasswordConfirm ? 'text' : 'password'"
      formControlName="passwordConfirm"
    />
    <mat-icon matPrefix>lock</mat-icon>
    <mat-icon
      matSuffix
      (click)="showPasswordConfirm = !showPasswordConfirm"
      class="toggleShowPasswordButton"
      >{{ showPasswordConfirm ? "visibility" : "visibility_off" }}</mat-icon
    >
    <mat-hint>Should be same as password above</mat-hint>
  </mat-form-field>
</form>
<div
  class="bottom-centered-items"
  fxLayout="column"
  fxLayoutAlign="center center"
>
  <small>
    By signing up you accept the<br />
    <b (click)="this.showTermsOfService.emit()">Terms of Service</b> and
    <b (click)="this.showPrivacyPolicy.emit()">Privacy Policy</b>
  </small>

  <button mat-raised-button mat-button color="primary" (click)="submit()">
    Register
  </button>

  <span>Already registered? <b routerLink="/sign-in">Login</b></span>
</div>

<!-- <main>
  <mat-error class="errorbox" *ngIf="this.isInvalidParameter">
    Tarkista että sähköpostiosoite on oikea ja salasana on vähintään 8 merkkiä
    pitkä.
  </mat-error>
  <form
    fxLayout="column"
    fxLayoutAlign="center stretch"
    fxLayoutGap="8px"
    [formGroup]="signUpUserDataForm"
  >
    <span fxLayoutAlign="center center">
      <h1>Luo käyttäjätili</h1>
    </span>
    <mat-form-field appearance="outline">
      <mat-label>Sähköpostiosoite</mat-label>

      <input
        matInput
        type="email"
        formControlName="emailAddress"
        autocomplete="email"
      />

      <mat-error
        *ngIf="signUpUserDataForm.get('emailAddress')?.hasError('required')"
      >
        Sähköpostiosoite on pakollinen
      </mat-error>

      <mat-error
        *ngIf="
          signUpUserDataForm.get('emailAddress')?.touched &&
          signUpUserDataForm.get('emailAddress')?.hasError('email')
        "
      >
        Syötä kelvollinen sähköpostiosoite
      </mat-error>
      <mat-icon matPrefix>account_circle</mat-icon>
    </mat-form-field>
  </form>

  <form
    [formGroup]="passwordsForm"
    fxLayout="column"
    fxLayoutAlign="center stretch"
    fxLayoutGap="8px"
  >
    <mat-form-field appearance="outline">
      <mat-label>Salasana</mat-label>

      <input
        matInput
        id="password"
        [type]="showPassword ? 'text' : 'password'"
        formControlName="password"
      />

      <mat-error
        *ngIf="passwordsForm.get('password')?.hasError('minlength')"
      >
        Salasanan pitää olla vähintään 8 merkkiä pitkä
      </mat-error>

      <mat-error
        *ngIf="passwordsForm.get('password')?.hasError('required')"
      >
        Aseta salasana
      </mat-error>
      <mat-error
        *ngIf="passwordsForm.get('password')?.hasError('pattern')"
      >
        Välilyönnit ei sallittuja salasanan alussa tai lopussa
      </mat-error>
      <mat-icon matPrefix>lock</mat-icon>
      <mat-icon
        matSuffix
        (click)="showPassword = !showPassword"
        class="toggleShowPasswordButton"
        >{{ showPassword ? "visibility" : "visibility_off" }}</mat-icon
      >
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Vahvista salasana</mat-label>

      <input
        matInput
        [type]="showPasswordConfirm ? 'text' : 'password'"
        id="passwordConfirm"
        formControlName="passwordConfirm"
        [errorStateMatcher]="matcher"
      />
      <mat-error
        *ngIf="
          passwordsForm.get('passwordConfirm')?.dirty &&
          passwordsForm.hasError('notSame')
        "
      >
        Salasanojen on täsmättävä
      </mat-error>
      <mat-icon matPrefix>lock</mat-icon>
      <mat-icon
        matSuffix
        (click)="showPasswordConfirm = !showPasswordConfirm"
        class="toggleShowPasswordButton"
        >{{ showPasswordConfirm ? "visibility" : "visibility_off" }}</mat-icon
      >
    </mat-form-field>

    <small>
      Luomalla käyttäjätilin hyväksyt palvelumme<br />
      <u (click)="onShowTermsOfService()">Käyttöehdot</u> ja
      <u (click)="onShowPrivacyPolicy()">Tietosuojakäytännöt</u>
    </small>

    <button
      *ngIf="!isCommunicating"
      mat-raised-button
      mat-button
      color="primary"
      [disabled]="signUpUserDataForm.invalid"
      (click)="submit()"
    >
      Luo käyttäjätili
    </button>
    <clap-app-loading-spinner *ngIf="isCommunicating"></clap-app-loading-spinner>
  </form>
  <mat-divider></mat-divider>

  <div fxLayout="column" fxLayoutAlign="center stretch" fxLayoutGap="8px">
    <p fxLayoutAlign="center center">
      <span class="mat-small">Oletko jo rekisteröitynyt käyttäjäksi? </span>
    </p>

    <a mat-button routerLink="/sign-in" color="accent">Kirjaudu palveluun</a>
  </div>
</main> -->
